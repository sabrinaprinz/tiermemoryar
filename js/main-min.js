"use strict";var preparams={addCollisionListeners:!0,switchModelsRain:!0,raining:!1,buildWithMtl:!1},params={currentlyVisibleMarkers:[],moreThanTwoVisible:!1,foundPairs:0,hideAllElements:!1,all3DElements:[],audioPath:"audio/",assetsPath:"assets/",currentPairMatching:!1,skippedInitColisionHit:!1,initHits:0,models:[],reachedEnd:!1,badJokerPlayed:[],goodJokerPlayed:[],goodJokerActive:!1,goodJokerActiveId:"",officialMemorypairsLength:0},modelsSun=[["Hund_Vorne.obj","materials.mtl",[2,0,0],"dog1","normal"],["Hund_Hinten.obj","materials.mtl",[2,0,0],"dog2","normal"],["model.obj","materials.mtl",[0,0,0],"cat1","goodJoker"],["model.obj","materials.mtl",[0,0,0],"cat2","goodJoker"]],modelsRain=[["model.obj","materials.mtl",[0,0,0]],["model.obj","materials.mtl",[0,0,0],"normal"],["model.obj","materials.mtl",[0,0,0],"goodJoker"],["model.obj","materials.mtl",[0,0,0],"goodJoker"]],memorypairs=[["marker1_1","marker1_2",!1,"frog.mp3","normal"],["marker2_1","marker2_2",!1,"goodJoker.mp3","goodJoker"]];function addMarkerName(a){params.currentlyVisibleMarkers.push(a)}function removeMarkerName(e){var a,r=params.currentlyVisibleMarkers.filter(function(a){return a!==e});params.currentlyVisibleMarkers=r}function updateGame(){updateHowManyVisible(),checkPair(),updatePairsFound()}function updateHowManyVisible(){2<params.currentlyVisibleMarkers.length?(params.moreThanTwoVisible=!0,hideAllElements()):(params.hideAllElements&&showAllElements(),params.moreThanTwoVisible=!1)}function updatePairsFound(){var e=0,a;memorypairs.forEach(function(a){a[2]&&"normal"===a[4]&&e++}),document.getElementById("pairsFound").innerHTML=" ".concat(e," of ").concat(params.officialMemorypairsLength),e===params.officialMemorypairsLength&&(params.reachedEnd||(params.reachedEnd=!0,setTimeout(function(){$("#endOfTheGame").hide().css("opacity","1").fadeIn(800)},1500)))}function checkPair(){var a=params.currentlyVisibleMarkers.length;if(2==a||1==a)for(var e=[params.currentlyVisibleMarkers[0],params.currentlyVisibleMarkers[1]],r=0;r<e.length;r++){var o=e[r],t;if(void 0!==o)checkForSpecialCard(document.getElementById(o).dataset.cardtype,o)}if(2===a){var n=params.currentlyVisibleMarkers[0],i=params.currentlyVisibleMarkers[1];if(params.goodJokerActive){var s=params.goodJokerActiveId,l;l=s==n?i:n,memorypairs.forEach(function(a){var e;a.includes(l)&&!0!==a[2]&&(console.log("It's a match!"),celebrateMatch(),a[2]=!0,playSound(a[3]))}),params.goodJokerActive=!1}}}function checkForSpecialCard(a,e){var r,o;"badJoker"===a&&(arrayContains(e,params.badJokerPlayed)||(showBadJoker(),params.badJokerPlayed.push(e)));"goodJoker"===a&&(arrayContains(e,params.goodJokerPlayed)||(params.goodJokerActive=!0,params.goodJokerActiveId=e,params.goodJokerPlayed.push(e),1==params.currentlyVisibleMarkers.length&&playSound("goodJoker.mp3")))}function modelsHit(a){if(params.initHits++,params.initHits!==memorypairs.length||params.skippedInitColisionHit){if(params.skippedInitColisionHit){for(var e,r=a.path[1].id,o=0,t=0;t<memorypairs.length;t++){var n=memorypairs[t];if(n[0]===r||n[1]===r){o=t;break}}memorypairs[o][2]||(memorypairs[o][2]=!0,celebrateMatch(),playSound(memorypairs[o][3]))}updatePairsFound()}else params.skippedInitColisionHit=!0}function setOpacityCard(l,d){document.querySelectorAll("a-marker").forEach(function(a){if(a.id===l){var e=a.getElementsByTagName("*"),r=!0,o=!1,t=void 0;try{for(var n=e[Symbol.iterator](),i;!(r=(i=n.next()).done);r=!0){var s;i.value.components.material.material.opacity=d}}catch(a){o=!0,t=a}finally{try{r||null==n.return||n.return()}finally{if(o)throw t}}}})}function celebrateMatch(){$("#matchTitle").hide().css("opacity","1").fadeIn(800).fadeOut(800)}function showBadJoker(){$("#badJoker").hide().css("opacity","1").fadeIn(800).fadeOut(800),playSound("badJoker.mp3")}function addSound(){audioplayer=document.createElement("AUDIO"),audioplayer.src=params.audioPath+"frog.mp3",audioplayer.loop=!1,audioplayer.play(),audioplayer.pause()}function playSound(a){void 0!==a&&(audioplayer.src=params.audioPath+a,audioplayer.play())}function hideAllElements(){params.hideAllElements=!0,params.all3DElements.forEach(function(a){a.setAttribute("visible",!1)})}function showAllElements(){params.hideAllElements=!1,params.all3DElements.forEach(function(a){a.setAttribute("visible",!0)})}function addMarkerListeners(){var a;document.querySelectorAll("a-marker").forEach(function(a){a.addEventListener("markerFound",function(a){letMarkerId=a.target.id,addMarkerName(letMarkerId),updateGame()}),a.addEventListener("markerLost",function(a){letMarkerId=a.target.id,removeMarkerName(letMarkerId),updateGame()})}),document.querySelectorAll("a-marker").forEach(function(a){var e=a.getElementsByTagName("*"),r=!0,o=!1,t=void 0;try{for(var n=e[Symbol.iterator](),i;!(r=(i=n.next()).done);r=!0){var s=i.value;params.all3DElements.push(s)}}catch(a){o=!0,t=a}finally{try{r||null==n.return||n.return()}finally{if(o)throw t}}}),console.clear(),updatePairsFound()}function hideTitle(){$("#titleWrapper").fadeOut("slow")}function loadAframe(){document.querySelector("a-node").load()}function startGame(){addSound(),loadAframe(),addMarkerListeners(),hideTitle()}function checkRain(){preparams.raining=!1,setCorrectModels(),addCollisions(),setCorrectTotalCount()}function generateModelHtml(a,e,r,o,t){var n,i="";if(isEven(a)){var s=params.models[a+1][3];i="collision-".concat(t,' aabb-collider="objects: .').concat(s,'"')}return n=preparams.buildWithMtl?'<a-obj-model class="'.concat(t,'" src="').concat(params.assetsPath).concat(e,'" mtl="').concat(params.assetsPath).concat(r,'" position="').concat(o[0]," ").concat(o[1]," ").concat(o[2],'" ').concat(i,"></a-obj-model>"):'<a-obj-model class="'.concat(t,'" src="').concat(params.assetsPath).concat(e,'" position="').concat(o[0]," ").concat(o[1]," ").concat(o[2],'" ').concat(i,"></a-obj-model>")}function setCorrectModels(){params.models=returnCurrentModels();for(var a=document.querySelectorAll("a-marker"),e=0;e<params.models.length;e++){var r=params.models[e],o=generateModelHtml(e,r[0],r[1],r[2],r[3]);a[e].innerHTML=o,a[e].dataset.cardtype=r[4]}}function setCorrectTotalCount(){for(var a=0,e=0;e<memorypairs.length;e++){var r;"normal"==memorypairs[e][4]&&a++}params.officialMemorypairsLength=a}function returnCurrentModels(){var a;return a=preparams.raining?modelsRain:modelsSun}function addCollisions(){console.log("set collisions");for(var a=0;a<params.models.length;a++)if(isEven(a)){var e,r="collision-"+params.models[a][3];AFRAME.registerComponent(r,{init:function a(){this.el.addEventListener("hitstart",function(a){console.log(a),modelsHit(a)}),this.el.addEventListener("hit",function(a){}),this.el.addEventListener("hitend",function(a){console.log("hitend")})}})}}function init(){checkRain()}function isEven(a){return 0===(a=Number(a))||!(!a||a%2)}function arrayContains(a,e){return-1<e.indexOf(a)}init();