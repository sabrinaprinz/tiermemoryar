"use strict";var preparams={addCollisionListeners:!0,switchModelsRain:!0,raining:!1,buildWithMtl:!1},params={currentlyVisibleMarkers:[],moreThanTwoVisible:!1,foundPairs:0,hideAllElements:!1,all3DElements:[],audioPath:"audio/",assetsPath:"assets/",currentPairMatching:!1,skippedInitColisionHit:!1,initHits:0,models:[],reachedEnd:!1,badJokerPlayed:[],goodJokerPlayed:[],goodJokerActive:!1,goodJokerActiveId:""},modelsSun=[["Hund_Vorne.obj","materials.mtl",[2,0,0],"dog1","normal"],["Hund_Hinten.obj","materials.mtl",[2,0,0],"dog2","normal"],["model.obj","materials.mtl",[0,0,0],"cat1","goodJoker"],["model.obj","materials.mtl",[0,0,0],"cat2","goodJoker"]],modelsRain=[["model.obj","materials.mtl",[0,0,0]],["model.obj","materials.mtl",[0,0,0]],["model.obj","materials.mtl",[0,0,0]],["model.obj","materials.mtl",[0,0,0]]],memorypairs=[["marker1_1","marker1_2",!1,"frog.mp3"],["marker2_1","marker2_2",!1,"frog.mp3"]];function addMarkerName(e){params.currentlyVisibleMarkers.push(e)}function removeMarkerName(a){var e,r=params.currentlyVisibleMarkers.filter(function(e){return e!==a});params.currentlyVisibleMarkers=r}function updateGame(){updateHowManyVisible(),checkPair(),updatePairsFound()}function updateHowManyVisible(){2<params.currentlyVisibleMarkers.length?(params.moreThanTwoVisible=!0,hideAllElements()):(params.hideAllElements&&showAllElements(),params.moreThanTwoVisible=!1)}function updatePairsFound(){var a=0,e;memorypairs.forEach(function(e){e[2]&&a++}),document.getElementById("pairsFound").innerHTML=" ".concat(a," of ").concat(memorypairs.length),a===memorypairs.length&&(params.reachedEnd||(params.reachedEnd=!0,setTimeout(function(){$("#endOfTheGame").hide().css("opacity","1").fadeIn(800)},1500)))}function checkPair(){var e=params.currentlyVisibleMarkers.length;if(2==e||1==e)for(var a=[params.currentlyVisibleMarkers[0],params.currentlyVisibleMarkers[1]],r=0;r<a.length;r++){var o=a[r],t;if(void 0!==o)checkForSpecialCard(document.getElementById(o).dataset.cardtype,o)}if(2===e){var n=params.currentlyVisibleMarkers[0],i=params.currentlyVisibleMarkers[1];if(params.goodJokerActive){var s=params.goodJokerActiveId,l;l=s==n?i:n,memorypairs.forEach(function(e){var a;e.includes(l)&&!0!==e[2]&&(console.log("It's a match!"),celebrateMatch(),e[2]=!0,playSound(e[3]))}),params.goodJokerActive=!1}}}function checkForSpecialCard(e,a){var r,o;"badJoker"===e&&(arrayContains(a,params.badJokerPlayed)||(showBadJoker(),params.badJokerPlayed.push(a)));"goodJoker"===e&&(arrayContains(a,params.goodJokerPlayed)||(params.goodJokerActive=!0,params.goodJokerActiveId=a,params.goodJokerPlayed.push(a)))}function modelsHit(e){if(params.initHits++,params.initHits!==memorypairs.length||params.skippedInitColisionHit){if(params.skippedInitColisionHit){for(var a,r=e.path[1].id,o=0,t=0;t<memorypairs.length;t++){var n=memorypairs[t];if(n[0]===r||n[1]===r){o=t;break}}memorypairs[o][2]||(memorypairs[o][2]=!0,celebrateMatch(),playSound(memorypairs[o][3]))}updatePairsFound()}else params.skippedInitColisionHit=!0}function setOpacityCard(l,d){document.querySelectorAll("a-marker").forEach(function(e){if(e.id===l){var a=e.getElementsByTagName("*"),r=!0,o=!1,t=void 0;try{for(var n=a[Symbol.iterator](),i;!(r=(i=n.next()).done);r=!0){var s;i.value.components.material.material.opacity=d}}catch(e){o=!0,t=e}finally{try{r||null==n.return||n.return()}finally{if(o)throw t}}}})}function celebrateMatch(){$("#matchTitle").hide().css("opacity","1").fadeIn(800).fadeOut(800)}function showBadJoker(){$("#badJoker").hide().css("opacity","1").fadeIn(800).fadeOut(800),playSound("badJoker.mp3")}function addSound(){audioplayer=document.createElement("AUDIO"),audioplayer.src=params.audioPath+"frog.mp3",audioplayer.loop=!1,audioplayer.play(),audioplayer.pause()}function playSound(e){void 0!==e&&(audioplayer.src=params.audioPath+e,audioplayer.play())}function hideAllElements(){params.hideAllElements=!0,params.all3DElements.forEach(function(e){e.setAttribute("visible",!1)})}function showAllElements(){params.hideAllElements=!1,params.all3DElements.forEach(function(e){e.setAttribute("visible",!0)})}function addMarkerListeners(){var e;document.querySelectorAll("a-marker").forEach(function(e){e.addEventListener("markerFound",function(e){letMarkerId=e.target.id,addMarkerName(letMarkerId),updateGame()}),e.addEventListener("markerLost",function(e){letMarkerId=e.target.id,removeMarkerName(letMarkerId),updateGame()})}),document.querySelectorAll("a-marker").forEach(function(e){var a=e.getElementsByTagName("*"),r=!0,o=!1,t=void 0;try{for(var n=a[Symbol.iterator](),i;!(r=(i=n.next()).done);r=!0){var s=i.value;params.all3DElements.push(s)}}catch(e){o=!0,t=e}finally{try{r||null==n.return||n.return()}finally{if(o)throw t}}}),console.clear(),updatePairsFound()}function hideTitle(){$("#titleWrapper").fadeOut("slow")}function loadAframe(){document.querySelector("a-node").load()}function startGame(){addSound(),loadAframe(),addMarkerListeners(),hideTitle()}function checkRain(){preparams.raining=!1,setCorrectModels(),addCollisions()}function generateModelHtml(e,a,r,o,t){var n,i="";if(isEven(e)){var s=params.models[e+1][3];i="collision-".concat(t,' aabb-collider="objects: .').concat(s,'"')}return n=preparams.buildWithMtl?'<a-obj-model class="'.concat(t,'" src="').concat(params.assetsPath).concat(a,'" mtl="').concat(params.assetsPath).concat(r,'" position="').concat(o[0]," ").concat(o[1]," ").concat(o[2],'" ').concat(i,"></a-obj-model>"):'<a-obj-model class="'.concat(t,'" src="').concat(params.assetsPath).concat(a,'" position="').concat(o[0]," ").concat(o[1]," ").concat(o[2],'" ').concat(i,"></a-obj-model>")}function setCorrectModels(){params.models=returnCurrentModels();for(var e=document.querySelectorAll("a-marker"),a=0;a<params.models.length;a++){var r=params.models[a],o=generateModelHtml(a,r[0],r[1],r[2],r[3]);e[a].innerHTML=o,e[a].dataset.cardtype=r[4]}}function returnCurrentModels(){var e;return e=preparams.raining?modelsRain:modelsSun}function addCollisions(){console.log("set collisions");for(var e=0;e<params.models.length;e++)if(isEven(e)){var a,r="collision-"+params.models[e][3];AFRAME.registerComponent(r,{init:function e(){this.el.addEventListener("hitstart",function(e){console.log(e),modelsHit(e)}),this.el.addEventListener("hit",function(e){}),this.el.addEventListener("hitend",function(e){console.log("hitend")})}})}}function init(){checkRain()}function isEven(e){return 0===(e=Number(e))||!(!e||e%2)}function arrayContains(e,a){return-1<a.indexOf(e)}function removeFromArr(e,a){for(var r=e.indexOf(a);-1!==r;)e.splice(r,1),r=e.indexOf(a)}init();